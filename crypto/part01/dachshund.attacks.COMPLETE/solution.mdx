## Dachshund Attacks

###### AUTHOR: SARA
##### DESCRIPTION
What if `d` is too small? Connect with `nc mercury.picoctf.net 36463`.

##### WALKTHROUGH
Let's take a stab at that `nc`:
```bash
$ nc mercury.picoctf.net 36463
Welcome to my RSA challenge!
e: 140772901558686036193707139734640698879937335134961894074725107831759812993537393832976303234405266093841033031817537296826244686110689782986974105255599105183369382705301460077321216638152347430766101451278250914028621015854712532193635820572831172724285182485987263750815537276479332738651818880243360316207
n: 157195398460755071256060195105389938563268937328285564988666019092437032689779168174151847160364662178765622372834011546678063298000568933862619122502789135122424854201111327860333845025027522416939110385262297703223193509972115237626738218397538293059808078326686106798281095481269474784500641433028501809413
c: 22351652953153968871896272569703815162312080229225090167545775456735277502542939857639749721027257503404582242820237693548505861006374625325148586273637898553313892638224402711120340394456242252750912575743682813951754159971436118743231469284539553672089936847826056147426485537204504290405904518656984389353
```
All right, so now we have the `publickey(n)`, the `privatekey(e)`, and the cipher message that we need to decrypt/`c`. Let's try using the same tool as in `Mind your Ps and Qs`:
```bash
$ python3 RsaCtfTool.py -n 157195398460755071256060195105389938563268937328285564988666019092437032689779168174151847160364662178765622372834011546678063298000568933862619122502789135122424854201111327860333845025027522416939110385262297703223193509972115237626738218397538293059808078326686106798281095481269474784500641433028501809413 -e 140772901558686036193707139734640698879937335134961894074725107831759812993537393832976303234405266093841033031817537296826244686110689782986974105255599105183369382705301460077321216638152347430766101451278250914028621015854712532193635820572831172724285182485987263750815537276479332738651818880243360316207 --uncipher 22351652953153968871896272569703815162312080229225090167545775456735277502542939857639749721027257503404582242820237693548505861006374625325148586273637898553313892638224402711120340394456242252750912575743682813951754159971436118743231469284539553672089936847826056147426485537204504290405904518656984389353
private argument is not set, the private key will not be displayed, even if recovered.

[*] Testing key /tmp/tmpcy_s6y1f.
[*] Performing factordb attack on /tmp/tmpcy_s6y1f.
[*] Performing fibonacci_gcd attack on /tmp/tmpcy_s6y1f.
100%|█████████████████████████████████████████████████████████████| 9999/9999 [00:00<00:00, 30549.50it/s]
[*] Performing mersenne_primes attack on /tmp/tmpcy_s6y1f.
 27%|█████████████████▊                                               | 14/51 [00:00<00:00, 96579.37it/s]
[*] Performing pastctfprimes attack on /tmp/tmpcy_s6y1f.
100%|██████████████████████████████████████████████████████████████| 113/113 [00:00<00:00, 231311.06it/s]
[*] Performing smallq attack on /tmp/tmpcy_s6y1f.
[*] Performing system_primes_gcd attack on /tmp/tmpcy_s6y1f.
100%|████████████████████████████████████████████████████████████| 7007/7007 [00:00<00:00, 246361.83it/s]
[*] Performing SQUFOF attack on /tmp/tmpcy_s6y1f.
[!] Timeout.
[*] Performing boneh_durfee attack on /tmp/tmpcy_s6y1f.
Can't load boneh_durfee because sage binary is not installed
[*] Performing comfact_cn attack on /tmp/tmpcy_s6y1f.
[*] Performing cube_root attack on /tmp/tmpcy_s6y1f.
[*] Performing ecm2 attack on /tmp/tmpcy_s6y1f.
Can't load ecm2 because sage binary is not installed
[*] Performing fermat attack on /tmp/tmpcy_s6y1f.
[!] Timeout.
[*] Performing fermat_numbers_gcd attack on /tmp/tmpcy_s6y1f.
  0%|          | 30/9999 [00:53<7:39:37,  2.77s/it][!] Timeout.
  0%|          | 30/9999 [01:00<5:32:27,  2.00s/it]
[*] Performing mersenne_pm1_gcd attack on /tmp/tmpcy_s6y1f.
100%|███████| 1021/1021 [00:00<00:00, 32254.89it/s]
[*] Performing noveltyprimes attack on /tmp/tmpcy_s6y1f.
100%|███████████| 21/21 [00:00<00:00, 90338.86it/s]
[*] Performing nsif attack on /tmp/tmpcy_s6y1f.
[!] This attack module is not implemented yet
[*] Performing partial_q attack on /tmp/tmpcy_s6y1f.
[*] Performing pisano_period attack on /tmp/tmpcy_s6y1f.
Search_len: 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, log2(N): 1023
Search begin: 157195398460755071256060195105389938563268937328285564988666019092437032689779168174151847160364662178765622372834011546678063298000568933862619122502789035122424854201111327860333845025027522416939110385262297703223193509972115237626738218397538293059808078326686106798281095481269474784500641433028501809414, end: 157195398460755071256060195105389938563268937328285564988666019092437032689779168174151847160364662178765622372834011546678063298000568933862619122502789235122424854201111327860333845025027522416939110385262297703223193509972115237626738218397538293059808078326686106798281095481269474784500641433028501809412
[*] Performing pollard_p_1 attack on /tmp/tmpcy_s6y1f.
  0%|                      | 0/997 [00:02<?, ?it/s]
[*] Performing primorial_pm1_gcd attack on /tmp/tmpcy_s6y1f.
100%|██████| 10000/10000 [00:03<00:00, 3139.37it/s]
[*] Performing qicheng attack on /tmp/tmpcy_s6y1f.
Can't load qicheng because sage binary is not installed
[*] Performing siqs attack on /tmp/tmpcy_s6y1f.
Can't load siqs because yafu binary is not installed
[*] Performing small_crt_exp attack on /tmp/tmpcy_s6y1f.
Can't load small_crt_exp because sage binary is not installed
[*] Performing wiener attack on /tmp/tmpcy_s6y1f.
100%|███████████| 590/590 [00:01<00:00, 539.69it/s]
 24%|██▍       | 144/590 [00:00<00:00, 2013.68it/s]
[*] Attack success with wiener method !

Results for /tmp/tmpcy_s6y1f:

Unciphered data :
HEX : 0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007069636f4354467b70726f76696e675f7769656e65725f323633353435377d
INT (big endian) : 198614235373674103788888306985643587194108045477674049828366797219789354877
INT (little endian) : 87929423597352679385967218520166303991072976481688015390619332199393487159846427007656726002893661291688789949733998347484593955431421780017717645548309057720377739178319689349000771259261816797717335362676896926195097120075074880228214198840835344888918249631507726084030139901782753927540936914496464617472
utf-8 : picoCTF{proving_wiener_2635457}
utf-16 : 瀀捩䍯䙔灻潲楶杮睟敩敮彲㘲㔳㔴紷
STR : b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00picoCTF{proving_wiener_2635457}'
```
Hey! There is the flag shown in both the utf-8 and utf-16 section!

##### FLAG
picoCTF{proving_wiener_2635457}
